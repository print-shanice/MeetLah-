# Bug Fixes Applied

## Date Bug Fix âœ…
**Issue:** When clicking on day 18 in the calendar, the add event card showed 17/01/2026 instead of 18/01/2026. Same for all other days (off by one).

**Root Cause:** The `toISOString()` method converts dates to UTC timezone, which caused an off-by-one error for users in timezones ahead of UTC (like Singapore, UTC+8).

**Fix Applied:** Modified `/components/calendar/event-modal.tsx` to format dates using local timezone methods instead of `toISOString()`:
- Changed from: `selectedDate.toISOString().split("T")[0]`
- Changed to: Manual formatting using `getFullYear()`, `getMonth()`, and `getDate()`

**Files Modified:**
- `/components/calendar/event-modal.tsx`

---

## Punishment RLS Policy Bug Fix ðŸ”§
**Issue:** When trying to assign punishments to late participants in meetup events, getting error:
```
Failed to assign punishment: "new row violates row-level security policy for table 'event_punishments'"
```

**Root Cause:** The Row Level Security (RLS) policy on the `event_punishments` table only allowed the event creator to assign punishments. This prevented other calendar members from assigning punishments to late participants.

**Fix Created:** 
- Created migration file: `/scripts/008-fix-punishment-rls-policy.sql`
- Created helper script: `/scripts/apply-punishment-fix.js`
- Created documentation: `/scripts/PUNISHMENT_FIX_README.md`

**Action Required:** 
You need to apply the database migration to fix this issue. See `/scripts/PUNISHMENT_FIX_README.md` for detailed instructions.

**Quick Steps:**
1. Go to Supabase Dashboard (https://app.supabase.com)
2. Open SQL Editor
3. Copy contents of `/scripts/008-fix-punishment-rls-policy.sql`
4. Paste and run in SQL Editor

**What the Fix Does:**
- Allows **any calendar member** to assign punishments (not just event creator)
- Allows **any calendar member** to delete punishments
- Maintains security by restricting actions to calendar members only

---

## Summary

Both bugs have been addressed:

1. âœ… **Date display bug** - Fixed in code, no action required
2. ðŸ”§ **Punishment assignment bug** - Database migration created, requires manual application

The date bug is now fixed and will work immediately. The punishment bug requires you to run the SQL migration in your Supabase dashboard (takes ~30 seconds to apply).
